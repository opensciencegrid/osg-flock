<frontend advertise_delay="5" advertise_with_multiple="True" advertise_with_tcp="True" downtimes_file="frontenddowntime" frontend_monitor_index_page="False" frontend_name="OSPool" frontend_versioning="False" group_parallel_workers="2" loop_delay="60" restart_attempts="3" restart_interval="1800">
   <config ignore_down_entries="False">
      <idle_vms_total curb="19000" max="20000"/>
      <idle_vms_total_global curb="19000" max="20000"/>
      <running_glideins_total curb="95000" max="100000"/>
      <running_glideins_total_global curb="95000" max="100000"/>
   </config>
   <high_availability check_interval="300" enabled="False">
      <ha_frontends>
      </ha_frontends>
   </high_availability>
   <log_retention>
      <process_logs>
         <process_log backup_count="5" compression="" extension="info" max_days="7.0" max_mbytes="100.0" min_days="3.0" msg_types="INFO"/>
         <process_log backup_count="5" compression="" extension="err" max_days="7.0" max_mbytes="100.0" min_days="3.0" msg_types="ERR,WARN,EXCEPTION"/>
         <process_log backup_count="1" compression="" extension="dbg" max_days="7.0" max_mbytes="100.0" min_days="1.0" msg_types="DEBUG"/>
      </process_logs>
   </log_retention>
   <match match_expr='(
                          (job.get("DESIRED_Sites","nosite")=="nosite")
                          or
                          (glidein["attrs"]["GLIDEIN_Site"] in job.get("DESIRED_Sites","nosite").split(","))
                      )
                      and
                      (
                          (job.get("XENON_DESIRED_Sites","nosite")=="nosite")
                          or
                          (glidein["attrs"]["GLIDEIN_Site"] in job.get("XENON_DESIRED_Sites","nosite").split(","))
                      )
                      and
                      (
                          (job.get("UNDESIRED_Sites","nosite")=="nosite")
                          or
                          (glidein["attrs"]["GLIDEIN_Site"] not in job.get("UNDESIRED_Sites","nosite").split(","))
                      )
                      and
                      (
                          int(glidein["attrs"]["GLIDEIN_MaxMemMBs"] or 0) == 0
                          or
                          job.get("RequestMemory", 1024) &lt;= int(glidein["attrs"]["GLIDEIN_MaxMemMBs"] or 0)
                      )
                      and
                      (
                         job.get("SingularityImage", "") == ""
                         or
                         glidein["attrs"].get("GLIDEIN_SINGULARITY_REQUIRE", "OPTIONAL") != "NEVER"
                      )'
          start_expr='(isUndefined(MY.OSG_NODE_VALIDATED) || MY.OSG_NODE_VALIDATED) &amp;&amp;
                      (isUndefined(IsBlackHole) || IsBlackHole == False) &amp;&amp;
                      (isUndefined(HasExcessiveLoad) || HasExcessiveLoad == False) &amp;&amp;
                      ((DESIRED_Sites=?=undefined) || stringListMember(GLIDEIN_Site,DESIRED_Sites,",")) &amp;&amp;
                      ((UNDESIRED_Sites=?=undefined) || !stringListMember(GLIDEIN_Site,UNDESIRED_Sites,",")) &amp;&amp;
                      (isUndefined(TARGET.ProjectName) != True &amp;&amp; TARGET.ProjectName != "") &amp;&amp;
                      (ifThenElse(JobDurationCategory =!= undefined &amp;&amp; JobDurationCategory == "Long", 
                                  GLIDEIN_ToDie - CurrentTime &gt;= 144000,
                                  GLIDEIN_Max_Walltime =?= undefined || GLIDEIN_Max_Walltime &lt; 43200 || GLIDEIN_ToDie - CurrentTime &gt;= 36000))
                      '>
      <factory query_expr='GLIDEIN_ResourceName =!= "Nebraska"'>
         <match_attrs>
            <match_attr name="GLIDEIN_MaxMemMBs" type="int"/>
            <match_attr name="GLIDEIN_Site" type="string"/>
            <match_attr name="GLIDEIN_CPUS" type="string"/>
            <match_attr name="GLIDEIN_SINGULARITY_REQUIRE" type="string"/>
         </match_attrs>
         <collectors>
            <collector DN="/CN=gfactory-1.osg-htc.org" factory_identity="gfactory@gfactory-1.osg-htc.org" my_identity="feosgospool@gfactory-1.osg-htc.org" node="gfactory-1.osg-htc.org"/>
            <collector DN="/CN=gfactory-2.osg-htc.org" factory_identity="gfactory@gfactory-2.osg-htc.org" my_identity="feosgospool@gfactory-2.osg-htc.org" node="gfactory-2.osg-htc.org"/>
         </collectors>
      </factory>
      <job comment="Define job constraint and schedds globally for simplicity, on CHTC, only count jobs which wants glideins"
           query_expr="(JobUniverse==5) &amp;&amp; ((IsCHTCSubmit =!= true) || (WantGlidein =?= true)) &amp;&amp; (TargetAnnexName is Undefined) &amp;&amp; (ProjectName =!= &quot;KOTO&quot;)">
         <match_attrs>
            <match_attr name="UNDESIRED_Sites" type="string"/>
            <match_attr name="DESIRED_Sites" type="string"/>
            <match_attr name="RequestMemory" type="int"/>
            <match_attr name="RequestCpus" type="int"/>
            <match_attr name="SingularityImage" type="string"/>
         </match_attrs>
         <schedds>
         </schedds>
      </job>
   </match>
   <monitor base_dir="/var/lib/gwms-frontend/web-area/monitor" flot_dir="/usr/share/javascriptrrd/flot" javascriptRRD_dir="/usr/share/javascriptrrd/js" jquery_dir="/usr/share/javascriptrrd/flot"/>
   <monitor_footer display_txt="" href_link=""/>
   <security security_name="OSG_OSPool" idtoken_lifetime="720">
      <credentials>
          <!-- do not put any global credentials - we have some specific entries below which require one and only one credential -->
      </credentials>
   </security>
   <stage base_dir="/var/lib/gwms-frontend/web-area/stage" use_symlink="True" web_base_url="https://ospool-fe.osg.chtc.io/vofrontend/stage"/>
   <work base_dir="/var/lib/gwms-frontend/vofrontend" base_log_dir="/var/log/gwms-frontend"/>
   <attrs>
      <attr name="CONTINUE_IF_NO_PROXY" glidein_publish="True" job_publish="False" parameter="True" type="string" value="True"/>
      <attr name="CONDOR_OS" glidein_publish="False" job_publish="False" parameter="True" type="string" value="auto"/>
      <attr name="CONDOR_VERSION" glidein_publish="False" job_publish="False" parameter="True" type="string" value="25.x"/>
      <attr name="GLIDECLIENT_Rank" glidein_publish="False" job_publish="False" parameter="True" type="string" value="1"/>
      <attr name="GLIDEIN_CLAIM_WORKLIFE" glidein_publish="False" job_publish="False" parameter="True" type="int" value="10800"/>
      <attr name="GLIDEIN_CLAIM_WORKLIFE_DYNAMIC" glidein_publish="False" job_publish="False" parameter="True" type="int" value="10800"/>
      <attr name="GLIDEIN_Expose_Grid_Env" glidein_publish="True" job_publish="True" parameter="False" type="string" value="True"/>
      <attr name="GLIDEIN_Job_Max_Time" glidein_publish="True" job_publish="False" parameter="True" type="int" value="36000"/>
      <attr name="GLIDEIN_SINGULARITY_BINDPATH" glidein_publish="True" job_publish="True" parameter="False" type="string" value="/none"/>
      <!-- apptainer search order: system install, HTCondor, module, cvmfs -->
      <attr name="SINGULARITY_BIN" glidein_publish="True" job_publish="False" parameter="True" type="string" value="PATH"/>
      <!-- no restrictions, it prevents some images like cvmfsexec on Stampede2 -->
      <attr name="SINGULARITY_IMAGE_RESTRICTIONS" glidein_publish="True" job_publish="False" parameter="True" type="string" value="none"/>
      <attr name="OSG_DEFAULT_CONTAINER_DISTRIBUTION" glidein_publish="False" job_publish="False" parameter="True" type="string" value="10%__htc/rocky:8 80%__htc/rocky:9 5%__htc/debian:12 5%__htc/ubuntu:22.04"/>
      <attr name="OSG_DEFAULT_CONTAINER_DISTRIBUTION_GPU" glidein_publish="False" job_publish="False" parameter="True" type="string" value="100%__htc/rocky:9-cuda-12.6.0"/>
      <attr name="OSG_DEFAULT_CVMFS_DATA" glidein_publish="False" job_publish="False" parameter="True" type="string" value="/cvmfs/stash.osgstorage.org"/>
      <attr name="STARTD_JOB_ATTRS" glidein_publish="False" job_publish="False" parameter="True" type="string" value="ProjectName"/>
      <attr name="USE_MATCH_AUTH" glidein_publish="False" job_publish="False" parameter="True" type="string" value="True"/>
      <attr name="SYSLOG_HOST" parameter="False" type="expr" value="syslog.osg.chtc.io"/>
      <attr name="GLIDECLIENT_OSG_VO" glidein_publish="True" job_publish="True" parameter="False" type="string" value="OSG"/>
      <attr name="GLIDEIN_Glexec_Use" glidein_publish="True" job_publish="True" parameter="True" type="string" value="NEVER"/>
      <attr name="SLOTS_LAYOUT" glidein_publish="True" job_publish="True" parameter="False" type="string" value="partitionable"/>
      <attr name="GLIDEIN_Singularity_Use" glidein_publish="True" job_publish="False" parameter="True" type="string" value="PREFERRED"/>
   </attrs>
   <groups>

      <group name="AMNH" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="2" reserve="1"/>
            <idle_vms_per_entry curb="8" max="10"/>
            <idle_vms_total curb="150" max="200"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="10000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="9000" max="10000"/>
         </config>
         <match match_expr="True" start_expr="(TARGET.ITB_Sites =!= True)">
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVO_AMNH", GLIDEIN_Supported_VOs)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr="(TARGET.ITB_Sites =!= True)">
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
            <attr name="RANK" glidein_publish="True" job_publish="False" parameter="True" type="expr" value='(regexp("amnh-submit", RemoteOwner) =?= True) + (ProjectName =?= "AMNH")'/>
         </attrs>
         <files>
         </files>
      </group>

      <group name="gpu" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="50" reserve="5"/>
            <idle_vms_per_entry curb="190" max="200"/>
            <idle_vms_total curb="450" max="500"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="5000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="4900" max="5000"/>
         </config>
         <match match_expr="True" start_expr='((TARGET.RequestGPUs?:0) &gt; 0 || RoomForCPUOnlyJobs) &amp;&amp;
                                              (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVOGPU", Glidein_Supported_VOs)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr="isUndefined(DESIRED_Sites) &amp;&amp; RequestGPUs &gt; 0">
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
            <attr name="GLIDEIN_GPUS" glidein_publish="True" job_publish="True" parameter="True" type="int" value="1"/>
         </attrs>
         <files>
         </files>
      </group>

      <group name="main" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="100" reserve="10"/>
            <idle_vms_per_entry curb="450" max="500"/>
            <idle_vms_total curb="19000" max="20000"/>
            <processing_workers matchmakers="5"/>
            <running_glideins_per_entry max="80000" min="0" relative_to_queue="20"/>
            <running_glideins_total curb="95000" max="100000"/>
         </config>
         <match match_expr='True'
                start_expr='(TARGET.ITB_Sites =!= True) &amp;&amp; (TARGET.ITB_Factory =!= True) &amp;&amp;
                            (isUndefined(RequestGPUs) || RequestGPUs == 0) &amp;&amp;
                            (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp;
                                 (stringListMember("OSGVO", GLIDEIN_Supported_VOs) || stringListMember("OSGVO_MULTICORE", GLIDEIN_Supported_VOs)) &amp;&amp; 
                                 !regexp("project_id", GLIDEIN_SupportedAuthenticationMethod) &amp;&amp;
                                 (GLIDEIN_REQUIRE_VOMS =!= "True")'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr="isUndefined(RequiresWholeMachine) &amp;&amp; (ITB_Sites =!= True) &amp;&amp; (ITB_Factory =!= True) &amp;&amp; isUndefined(RequiresLongWalltime) &amp;&amp; isUndefined(RequiresBigMem) &amp;&amp; (isUndefined(RequestGPUs) || RequestGPUs == 0)">
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
         </attrs>
         <files>
         </files>
      </group>


      <!-- ==================== ePIC ==================== -->

      <group name="epic" comment="ePIC unique resources" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="10" reserve="1"/>
            <idle_vms_per_entry curb="30" max="40"/>
            <idle_vms_total curb="300" max="400"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="5000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="9000" max="10000"/>
         </config>
         <match match_expr='True'
                start_expr='(TARGET.projectName =?= "ePIC") &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp;
                            (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
         <factory query_expr='(FactoryType =?= "production") &amp;&amp; stringListMember("EPICVO", GLIDEIN_Supported_VOs)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(projectName =?= "ePIC") &amp;&amp; (TARGET.ITB_Sites =!= True)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="/CN=ap23.uc.osg-htc.org" fullname="ap23.uc.osg-htc.org"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
            </credentials>
         </security>
         <attrs>
            <attr name="GLIDEIN_Job_Max_Time" glidein_publish="True" job_publish="False" parameter="True" type="int" value="7200"/>
         </attrs>
         <files>
         </files>
      </group>

      <!-- ==================== SPT ==================== -->
      
      <group name="spt-osgvo" comment="SPT dedicated resources, but under OSG VO" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="10" reserve="1"/>
            <idle_vms_per_entry curb="15" max="20"/>
            <idle_vms_total curb="150" max="200"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="10000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="9000" max="10000"/>
         </config>
         <match match_expr="True" start_expr='(TARGET.projectName =?= "spt") &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp; (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVO_SPT", GLIDEIN_Supported_VOs)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(projectName =?= "spt") &amp;&amp; (TARGET.ITB_Sites =!= True)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
         </attrs>
         <files>
         </files>
      </group>

      <group name="spt-osgvo-highmem" comment="SPT dedicated resources, but under OSG VO" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="10" reserve="1"/>
            <idle_vms_per_entry curb="15" max="20"/>
            <idle_vms_total curb="150" max="200"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="10000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="9000" max="10000"/>
         </config>
         <match match_expr="True" start_expr='(TARGET.projectName =?= "spt") &amp;&amp; (RequestMemory >= 384000) &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp; (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVO_SPT_HIGHMEM", GLIDEIN_Supported_VOs)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(projectName =?= "spt") &amp;&amp; (RequestMemory >= 384000) &amp;&amp; (TARGET.ITB_Sites =!= True)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
         </attrs>
         <files>
         </files>
      </group>
      
      <!-- ==================== OSG-Staff ==================== -->

      <group name="alloc-OSGStaff-Anvil" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="1" reserve="1"/>
            <idle_vms_per_entry curb="1" max="1"/>
            <idle_vms_total curb="1" max="1"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="2" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="1" max="2"/>
         </config>
         <match
             match_expr="True"
             start_expr='(TARGET.ProjectName == "OSG-Staff") &amp;&amp; (isString(TARGET.Desired_Allocations) &amp;&amp; stringListIMember("Anvil", TARGET.Desired_Allocations, ",")) &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp; (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVOAllocation", GLIDEIN_Supported_VOs) &amp;&amp; GLIDEIN_Site == "Purdue-Anvil"'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(ProjectName=?="OSG-Staff") &amp;&amp;(isString(Desired_Allocations) &amp;&amp; stringListIMember("Anvil", Desired_Allocations, ",")) &amp;&amp; (isUndefined(RequestGPUs) || RequestGPUs == 0)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                {{{schedd_blob}}}
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
                <!-- project_id: OSG-Staff is allowed to use the allocation ddm160003 -->
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" project_id="ddm160003,OSG-Staff" security_class="frontend" trust_domain="grid" type="scitoken+project_id"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
            <attr name="SINGULARITY_IMAGE_RESTRICTIONS" glidein_publish="True" job_publish="False" parameter="True" type="string" value="none"/>
         </attrs>
         <files>
         </files>
      </group>

      <!-- ==================== ICECUBE ==================== -->

      <group name="icecube" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="10" reserve="1"/>
            <idle_vms_per_entry curb="0" max="10"/>
            <idle_vms_total curb="180" max="200"/>
            <processing_workers matchmakers="5"/>
            <running_glideins_per_entry max="1000" min="0" relative_to_queue="3"/>
            <running_glideins_total curb="950" max="1000"/>
         </config>
         <match match_expr='True'
                start_expr='(TARGET.ITB_Sites =!= True) &amp;&amp; (TARGET.ITB_Factory =!= True) &amp;&amp;
                            (TARGET.RequestGPUs ?: 0) =?= 0  &amp;&amp;
                            (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE) &amp;&amp;
                            (regexp("grid-submitter", User) == True)'>
            <factory query_expr='FactoryType == "production" &amp;&amp;
                                 stringListMember("IceCube", GLIDEIN_Supported_VOs) &amp;&amp;
                                 GLIDEIN_ResourceName =!= "GLOW" &amp;&amp;
                                 !regexp("project_id", GLIDEIN_SupportedAuthenticationMethod)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='ProjectName =?= "IceCube" &amp;&amp; (RequestGPUs ?: 0) =?= 0 &amp;&amp; (OriginalTime ?: 0) &lt;= 20 * 60 * 60 &amp;&amp; (is_itb ?: False) =?= False'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="grid-submitter.icecube.wisc.edu" fullname="grid-submitter.icecube.wisc.edu"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout_icecube.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
         </attrs>
         <files>
         </files>
      </group>

      <group name="icecube-gpu" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="5" reserve="1"/>
            <idle_vms_per_entry curb="4" max="5"/>
            <idle_vms_total curb="180" max="200"/>
            <processing_workers matchmakers="5"/>
            <running_glideins_per_entry max="200" min="0" relative_to_queue="3"/>
            <running_glideins_total curb="180" max="200"/>
         </config>
         <match match_expr='True'
                start_expr='(is_itb ?: False) =?= False &amp;&amp; (TARGET.ITB_Factory =!= True) &amp;&amp;
                            (TARGET.RequestGPUs ?: 0) &gt;= 1  &amp;&amp;
                            (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE) &amp;&amp;
                            (regexp("grid-submitter", User) == True)'>
            <factory query_expr='FactoryType == "production" &amp;&amp;
                                 stringListMember("IceCubeGPU", GLIDEIN_Supported_VOs) &amp;&amp;
                                 GLIDEIN_ResourceName =!= "GLOW" &amp;&amp;
                                 !regexp("project_id", GLIDEIN_SupportedAuthenticationMethod)'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='ProjectName =?= "IceCube" &amp;&amp; (RequestGPUs ?: 0) &gt;= 1 &amp;&amp; (OriginalTime ?: 0) &lt;= 20 * 60 * 60 &amp;&amp; (is_itb ?: False) =?= False'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="grid-submitter.icecube.wisc.edu" fullname="grid-submitter.icecube.wisc.edu"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout_icecube.py" security_class="frontend" trust_domain="grid" type="scitoken"/>
            </credentials>
         </security>
         <attrs>
         </attrs>
         <files>
         </files>
      </group>

      <group name="alloc-IceCube-Anvil-GPU" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="True" type="DISABLE" wait="30"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="20" reserve="1"/>
            <idle_vms_per_entry curb="950" max="1000"/>
            <idle_vms_total curb="950" max="1000"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="1000" min="1" relative_to_queue="5.0"/>
            <running_glideins_total curb="950" max="1000"/>
         </config>
         <match
             match_expr="True"
             start_expr='(TARGET.ProjectName == "IceCube") &amp;&amp; (isString(TARGET.Desired_Allocations) &amp;&amp; stringListIMember("Anvil", TARGET.Desired_Allocations, ",")) &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp;
                         ((TARGET.RequestGPUs?:0) &gt; 0 || RoomForCPUOnlyJobs) &amp;&amp;
                         (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVOAllocationGPU", GLIDEIN_Supported_VOs) &amp;&amp; GLIDEIN_Site == "Purdue-Anvil"'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(ProjectName=?="IceCube") &amp;&amp;(isString(Desired_Allocations) &amp;&amp; stringListIMember("Anvil", Desired_Allocations, ",")) &amp;&amp; (RequestGPUs &gt;= 1)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="/CN=grid-submitter.icecube.wisc.edu" fullname="grid-submitter.icecube.wisc.edu"/>
                  <schedd DN="/CN=sub-2.icecube.wisc.edu" fullname="sub-2.icecube.wisc.edu"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
                <!-- project_id: IceCube is allowed to use the allocation phy150040-gpu -->
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" project_id="phy150040-gpu,IceCube" security_class="frontend" trust_domain="grid" type="scitoken+project_id"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
            <attr name="SINGULARITY_IMAGE_RESTRICTIONS" glidein_publish="True" job_publish="False" parameter="True" type="string" value="none"/>
         </attrs>
         <files>
         </files>
      </group>

      <group name="alloc-IceCube-Delta-GPU" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="True" type="DISABLE" wait="30"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="20" reserve="1"/>
            <idle_vms_per_entry curb="950" max="1000"/>
            <idle_vms_total curb="950" max="1000"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="1000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="950" max="1000"/>
         </config>
         <match
             match_expr="True"
             start_expr='(TARGET.ProjectName == "IceCube") &amp;&amp; (isString(TARGET.Desired_Allocations) &amp;&amp; stringListIMember("Delta", TARGET.Desired_Allocations, ",")) &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp;
                         ((TARGET.RequestGPUs?:0) &gt; 0 || RoomForCPUOnlyJobs) &amp;&amp;
                         (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVOAllocationGPU", GLIDEIN_Supported_VOs) &amp;&amp; GLIDEIN_Site == "NCSA-Delta"'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(ProjectName=?="IceCube") &amp;&amp;(isString(Desired_Allocations) &amp;&amp; stringListIMember("Delta", Desired_Allocations, ",")) &amp;&amp; (RequestGPUs &gt;= 1)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="/CN=grid-submitter.icecube.wisc.edu" fullname="grid-submitter.icecube.wisc.edu"/>
                  <schedd DN="/CN=sub-2.icecube.wisc.edu" fullname="sub-2.icecube.wisc.edu"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <!-- project_id: IceCube is allowed to use the allocation bbfw-delta-gpu -->
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" project_id="bbfw-delta-gpu,IceCube" security_class="frontend" trust_domain="grid" type="scitoken+project_id"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
            <attr name="SINGULARITY_IMAGE_RESTRICTIONS" glidein_publish="True" job_publish="False" parameter="True" type="string" value="none"/>
         </attrs>
         <files>
         </files>
     </group>

      <group name="alloc-IceCube-DESY-GPU" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="True" type="DISABLE" wait="30"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="20" reserve="1"/>
            <idle_vms_per_entry curb="950" max="1000"/>
            <idle_vms_total curb="950" max="1000"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="1000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="950" max="1000"/>
         </config>
         <match
             match_expr="True"
             start_expr='(TARGET.ProjectName == "IceCube") &amp;&amp; (isString(TARGET.Desired_Allocations) &amp;&amp; stringListIMember("DESY-ZN", TARGET.Desired_Allocations, ",")) &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp;
                         ((TARGET.RequestGPUs?:0) &gt; 0 || RoomForCPUOnlyJobs) &amp;&amp;
                         (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='FactoryType == "production" &amp;&amp; stringListMember("OSGVOAllocationGPU", GLIDEIN_Supported_VOs) &amp;&amp; GLIDEIN_Site == "DESY-ZN"'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(ProjectName=?="IceCube") &amp;&amp;(isString(Desired_Allocations) &amp;&amp; stringListIMember("DESY-ZN", Desired_Allocations, ",")) &amp;&amp; (RequestGPUs &gt;= 1) &amp;&amp; (RequestCPUs &lt;= 4) &amp;&amp; (RequestMemory &lt; 16000)'>
               <match_attrs>
               </match_attrs>
               <schedds>
                  <schedd DN="/CN=grid-submitter.icecube.wisc.edu" fullname="grid-submitter.icecube.wisc.edu"/>
                  <schedd DN="/CN=sub-2.icecube.wisc.edu" fullname="sub-2.icecube.wisc.edu"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <!-- project_id: IceCube is allowed to use the allocation -->
               <credential generator="scitokens_callout" absfname="/etc/gwms-frontend/plugin.d/scitokens_callout.py" project_id="icecube-desy-gpu,IceCube" security_class="frontend" trust_domain="grid" type="scitoken+project_id"/>
            </credentials>
         </security>
         <attrs>
            <attr name="User_Allocated_Resource" glidein_publish="True" job_publish="False" parameter="True" type="expr" value="True"/>
            <attr name="SINGULARITY_IMAGE_RESTRICTIONS" glidein_publish="True" job_publish="False" parameter="True" type="string" value="none"/>
         </attrs>
         <files>
         </files>
      </group>

      <!-- ==================== XENON ==================== -->

      <group name="xenon" comment="Using a XENON credential to submit under that XENON1T VO instead of the OSG VO" enabled="True">
         <config ignore_down_entries="">
            <glideins_removal margin="0" requests_tracking="False" type="NO" wait="0"/>
            <idle_glideins_lifetime max="864000"/>
            <idle_glideins_per_entry max="10" reserve="1"/>
            <idle_vms_per_entry curb="30" max="40"/>
            <idle_vms_total curb="300" max="400"/>
            <processing_workers matchmakers="3"/>
            <running_glideins_per_entry max="5000" min="0" relative_to_queue="5.0"/>
            <running_glideins_total curb="9000" max="10000"/>
         </config>
         <match match_expr='True'
                start_expr='((XENON_DESIRED_Sites=?=undefined) || stringListMember(GLIDEIN_Site,XENON_DESIRED_Sites,",")) &amp;&amp;
                            (TARGET.projectName =?= "xenon") &amp;&amp; (TARGET.ITB_Sites =!= True) &amp;&amp;
                            (isUndefined(TARGET.SingularityImage) || SINGULARITY_START_CLAUSE)'>
            <factory query_expr='(FactoryType =?= "production" || FactoryType =?= "CERN-Prod") &amp;&amp; stringListMember("XENON1T", GLIDEIN_Supported_VOs) &amp;&amp;
                                 !StringListMember(GLIDEIN_ResourceName, "WEIZMANN-LCG2")'>
               <match_attrs>
               </match_attrs>
               <collectors>
               </collectors>
            </factory>
            <job query_expr='(projectName =?= "xenon") &amp;&amp; (TARGET.ITB_Sites =!= True)'>
               <match_attrs>
                  <match_attr name="XENON_DESIRED_Sites" type="string"/>
               </match_attrs>
               <schedds>
                  <schedd DN="/CN=ap23.uc.osg-htc.org" fullname="ap23.uc.osg-htc.org"/>
               </schedds>
            </job>
         </match>
         <security>
            <credentials>
               <credential absfname="/etc/condor/certs/xenon-pilot.proxy" security_class="frontend" trust_domain="grid" type="grid_proxy"/>
            </credentials>
         </security>
         <attrs>
            <attr name="GLIDEIN_Job_Max_Time" glidein_publish="True" job_publish="False" parameter="True" type="int" value="7200"/>
            <attr name="GLIDEIN_DEBUG_OPTIONS" glidein_publish="True" job_publish="True" parameter="False" type="string" value="userjob"/>
            <attr name="GLIDEIN_DEBUG_OUTPUT" glidein_publish="True" job_publish="True" parameter="False" type="string" value="true"/>
         </attrs>
         <files>
         </files>
      </group>



   </groups>
   <ccbs>
      <ccb DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=ospool.opensciencegrid.org" group="ccb1" node="ccb-1.ospool.osg-htc.org:9618?sock=collector1-10"/>
      <ccb DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=ospool.opensciencegrid.org" group="ccb2" node="ccb-2.ospool.osg-htc.org:9618?sock=collector1-10"/>
   </ccbs>
   <collectors>
      <!-- main set -->
      <collector DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=ospool.opensciencegrid.org" group="default" node="cm-1.ospool.osg-htc.org:9618" secondary="False"/>
      <collector DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=flock.opensciencegrid.org" group="default" node="cm-1.ospool.osg-htc.org:9618?sock=collector1-10" secondary="True"/>
      <!-- HA set -->
      <collector DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=ospool.opensciencegrid.org" group="river" node="cm-2.ospool.osg-htc.org:9618" secondary="False"/>
      <collector DN="/DC=org/DC=incommon/C=US/ST=Wisconsin/L=Madison/O=University of Wisconsin-Madison/OU=OCIS/CN=flock.opensciencegrid.org" group="river" node="cm-2.ospool.osg-htc.org:9618?sock=collector1-10" secondary="True"/>
   </collectors>
   <files>
      <file absfname="/opt/osg-flock/tools/garbage_collection/garbage_collection.aarch64" after_entry="True" after_group="False" const="True" executable="False" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/tools/garbage_collection/garbage_collection.x86_64" after_entry="True" after_group="False"  const="True" executable="False" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/tools/garbage_collection/garbage_collection.opt-out" after_entry="True" after_group="False"  const="True" executable="False" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/tools/garbage_collection/garbage_collection" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/node-check/osgvo-node-validation" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/node-check/ligo-cvmfs-storage-check.sh" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/node-check/ulimits-check" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/node-check/scitokens" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/node-check/eic-data-attributes" after_entry="True" after_group="False" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/etc/pelican-exceptions.csv" after_entry="False" const="True" executable="False" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/lib/ospool-lib" after_entry="False" const="True" executable="True" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/pilot/additional-htcondor-config" after_entry="True" const="True" executable="True" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/pilot/default-image" after_entry="False" const="True" executable="True" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/pilot/singularity-extras" after_entry="True" const="True" executable="True" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/job/simple-job-wrapper.sh" after_entry="True" const="True" executable="False" period="0" prefix="GLIDEIN_PS_" untar="False" wrapper="True">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/job/prepare-hook" after_entry="False" const="True" executable="False" period="0" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/pilot/advertise-base" after_entry="True" const="True" executable="True" period="180" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/osg-flock/ospool-pilot/main/pilot/advertise-userenv" type="run:singularity" after_entry="True" const="True" executable="True" prefix="NOPREFIX" untar="False" wrapper="False">
         <untar_options cond_attr="TRUE"/>
      </file>
      <file absfname="/opt/rsyslog-pilot/rsyslog.tar.gz" prefix="NOPREFIX" untar="True">
          <untar_options cond_attr="TRUE" dir="../rsyslog"/>
      </file>
      <file absfname="/opt/rsyslog-pilot/rsyslog_startup.sh" executable="True" prefix="NOPREFIX"/>
   </files>
</frontend>
